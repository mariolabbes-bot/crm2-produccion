-- VENTAS LOTE 78 de 78
-- Registros 77001 a 77029

-- Carga de datos

INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Factura Venta', '331323', '2025-01-02', '77484660-3', 'BORDONES Y BORDONES LTDA.', NULL, NULL, '2', 'PTMO15', 'ANTICONGELANTE 611-E ESPECIAL', 36, 1744, 62784);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Factura Venta', '331323', '2025-01-02', '77484660-3', 'BORDONES Y BORDONES LTDA.', NULL, NULL, '3', 'TOT-213769', 'CAJA TOTAL QUARTZ INEO MC3 5W30 12X1', 1, 83553, 83553);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Factura Venta', '331323', '2025-01-02', '77484660-3', 'BORDONES Y BORDONES LTDA.', NULL, NULL, '4', 'SHE-550040618', 'CAJA HELIX ULTRA PRO AG 5W30 12X1 (EU)', 2, 70877, 141754);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Factura Venta', '331323', '2025-01-02', '77484660-3', 'BORDONES Y BORDONES LTDA.', NULL, NULL, '5', 'SHE-550040331', 'CAJA GENERIC OIL 4 LITROS', 4, 57200, 228800);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Factura Venta', '331323', '2025-01-02', '77484660-3', 'BORDONES Y BORDONES LTDA.', NULL, NULL, '6', 'SHE-550052652', 'CAJA SHELL HELIX ULTRA SP 0W20 3X5', 2, 107973, 215946);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Factura Venta', '331323', '2025-01-02', '77484660-3', 'BORDONES Y BORDONES LTDA.', NULL, NULL, '7', 'SHE-550052838', 'CAJA SHEL HELIX ULTRA 5W40 3X5', 4, 93039, 372156);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Factura Venta', '331322', '2025-01-02', '78794710-7', 'TRANSPORTES CALLEGARI LTDA.', NULL, NULL, '1', 'AP6500137', '295/80R22.5 152/149M S202 APLUS', 2, 160973, 321946);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Ovalle', 'Factura Venta', '331321', '2025-01-02', '11513397-7', 'EXEQUIEL LOPEZ', NULL, NULL, '1', 'MI984780', '295/80R22.5 X MULTI Z2 TL 154/150L VG MICHELIN', 2, 448107, 896214);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Ovalle', 'Factura Venta', '331321', '2025-01-02', '11513397-7', 'EXEQUIEL LOPEZ', NULL, NULL, '2', 'AP501000015', '11R22.5 148/145M S600 APLUS', 14, 145402, 2035628);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Ovalle', 'Factura Venta', '331321', '2025-01-02', '11513397-7', 'EXEQUIEL LOPEZ', NULL, NULL, '3', 'AP7500030', '11R22.5 146/143K D860 APLUS', 8, 167052, 1336416);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Ovalle', 'Factura Venta', '331321', '2025-01-02', '11513397-7', 'EXEQUIEL LOPEZ', NULL, NULL, '4', 'AP7500082', '295/80R22.5 152/149K D860 APLUS', 8, 165803, 1326424);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Ovalle', 'Factura Venta', '331321', '2025-01-02', '11513397-7', 'EXEQUIEL LOPEZ', NULL, NULL, '5', 'AP8004643', '295/80R22.5 152/149M S201+ APLUS', 2, 192772, 385544);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Factura Venta', '331320', '2025-01-02', '77307843-2', 'COMERCIAL PAULA FRANCISCA MILLA ORTIZ EIRL', NULL, NULL, '1', '711-GL', 'ANTICONGELANTE 711-GL', 12, 3297, 39564);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Factura Venta', '331319', '2025-01-02', '79648980-4', 'SOCIEDAD COMERCIAL DELARD Y CIA.', NULL, NULL, '1', 'SHE-550040331', 'CAJA GENERIC OIL 4 LITROS', 5, 57200, 286000);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Factura Venta', '331319', '2025-01-02', '79648980-4', 'SOCIEDAD COMERCIAL DELARD Y CIA.', NULL, NULL, '2', '711-GL', 'ANTICONGELANTE 711-GL', 18, 3297, 59346);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Factura Venta', '331319', '2025-01-02', '79648980-4', 'SOCIEDAD COMERCIAL DELARD Y CIA.', NULL, NULL, '3', 'PTMO15', 'ANTICONGELANTE 611-E ESPECIAL', 18, 1744, 31392);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Boleta', '128610', '2025-01-02', '66666666-6', 'Cliente GERONIMO MENDEZ Generico', NULL, NULL, '1', 'PTMO15', 'ANTICONGELANTE 611-E ESPECIAL', 2, 2207, 4414);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Factura Venta', '331318', '2025-01-02', '5212997-4', 'LUIS MU√ëOZ', NULL, NULL, '1', 'SHE-550040331', 'CAJA GENERIC OIL 4 LITROS', 5, 57200, 286000);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Boleta', '128609', '2025-01-02', '66666666-6', 'Cliente retail generico', NULL, NULL, '1', 'SHE-550040331L', 'BIDON HELIX HX7 10W40 (EU) 4 LTS', 1, 21609, 21609);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Boleta', '128609', '2025-01-02', '66666666-6', 'Cliente retail generico', NULL, NULL, '2', 'FW67/88', 'W67/88 FILTRO DE ACEITE LONG LIFE KIA', 1, 5302, 5302);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Factura Venta', '331317', '2025-01-02', '7613432-4', 'CARLOS VARGAS', NULL, NULL, '1', 'AP1016891', '235/75R15 104/101S ALL TERRAIN A929 APLUS', 4, 62605, 250420);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Factura Venta', '331316', '2025-01-02', '77528325-4', 'CAMPUSANO SPA', NULL, NULL, '1', 'SHE-550040331', 'CAJA GENERIC OIL 4 LITROS', 15, 57200, 858000);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Factura Venta', '331316', '2025-01-02', '77528325-4', 'CAMPUSANO SPA', NULL, NULL, '2', 'SHE-550040557', 'CAJA HELIX ULTRA AG 5W30 3X5 LT (EU)', 6, 82786, 496716);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Factura Venta', '331316', '2025-01-02', '77528325-4', 'CAMPUSANO SPA', NULL, NULL, '3', 'SHE-550040618', 'CAJA HELIX ULTRA PRO AG 5W30 12X1 (EU)', 1, 70877, 70877);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Factura Venta', '331316', '2025-01-02', '77528325-4', 'CAMPUSANO SPA', NULL, NULL, '4', 'SHE-550046394', 'CAJA HELIX HX8 ECT C3 5W30 3X5 (EU)', 2, 86309, 172618);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Factura Venta', '331316', '2025-01-02', '77528325-4', 'CAMPUSANO SPA', NULL, NULL, '5', 'SHE-550039983', 'CAJA SHELL HELIX HX5 15W40 4X4 (EU)', 1, 66967, 66967);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Geronimo Mendez', 'Factura Venta', '331315', '2025-01-02', '11439951-5', 'WILSON GUTIERREZ', NULL, NULL, '1', 'SHE-550040331', 'CAJA GENERIC OIL 4 LITROS', 5, 57200, 286000);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Antillanca', 'Nota Cr√©dito', '24985', '2025-01-02', '76933689-3', 'INTERSUPPLY INVERSIONES LIMITADA', NULL, NULL, '1', 'REA295T3UZY', '295/80R22.5  UZY REFORMADO T3', 1, -95000, -95000);
INSERT INTO venta (sucursal, tipo_documento, folio, fecha_emision, identificador, cliente, vendedor_cliente, vendedor_documento, indice, sku, descripcion, cantidad, precio, valor_total) VALUES ('Antillanca', 'Nota Cr√©dito', '24984', '2025-01-02', '8281372-1', 'JOSE PATRICIO HERRERA', NULL, NULL, '1', 'AP7516997', '295/80R22.5 154/151 M S207 APLUS', 2, -186236, -372472);

-- PASO FINAL: Actualizar vendedores desde tabla CLIENTES
-- Verifica la carga
SELECT COUNT(*) as total_ventas FROM venta;
SELECT fecha_emision, COUNT(*) as num_ventas FROM venta GROUP BY fecha_emision ORDER BY fecha_emision DESC LIMIT 10;

-- PASO CRÍTICO: Actualizar vendedores desde tabla CLIENTES
-- Esto establece la relación cliente-vendedor de forma consistente
UPDATE venta v
SET vendedor_cliente = c.nombre_vendedor,
    vendedor_documento = c.nombre_vendedor
FROM cliente c
WHERE v.identificador = c.rut
AND c.nombre_vendedor IS NOT NULL;

-- Verificar actualización de vendedores
SELECT 
    COUNT(*) as total_ventas,
    COUNT(vendedor_cliente) as con_vendedor,
    COUNT(*) - COUNT(vendedor_cliente) as sin_vendedor
FROM venta;

-- Ventas por vendedor
SELECT vendedor_cliente, COUNT(*) as num_ventas, SUM(valor_total) as total_vendido FROM venta WHERE vendedor_cliente IS NOT NULL GROUP BY vendedor_cliente ORDER BY total_vendido DESC;
